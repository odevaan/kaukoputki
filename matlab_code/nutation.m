function [dphi,deps]=nutation(jde);
%function [dphi,deps]=nutation(jde);
%
%Calculates the nutation quantities \Delta\phi and
%\Delta\epsilon for given julian ephemeris date jde.
%[Meeus, J., Astronomical algorithms, p. 131, Willmann-Bell (1991)]
%
%P. Paakkonen (2000)

rad=pi/180;
N=length(jde(:));
t=ones(4,1)*(jde(:)'-2451545)/36525; t(1,:)=1;
t=cumprod(t);

A=[(297.85036+445267.11148*t(2,:)-0.0019142*t(3,:)+t(4,:)/189474)
   (357.52772+35999.050340*t(2,:)-0.0001603*t(3,:)-t(4,:)/300000)
   (134.96298+477198.867398*t(2,:)+0.0086972*t(3,:)+t(4,:)/56250)
   (93.27191+483202.017358*t(2,:)-0.0036825*t(3,:)+t(4,:)/327270)
   (125.04452-1934.136261*t(2,:)+0.0020708*t(3,:)+t(4,:)/450000)]*rad;

M=[0 0 0 0 1; -2 0 0 2 2; 0 0 0 2 2; 0 0 0 0 2; 0 1 0 0 0; 0 0 1 0 0; 
-2 1 0 2 2; 0 0 0 2 1; 0 0 1 2 2; -2 -1 0 2 2; -2 0 1 0 0; -2 0 0 2 1; 
0 0 -1 2 2; 2 0 0 0 0; 0 0 1 0 1; 2 0 -1 2 2; 0 0 -1 0 1; 0 0 1 2 1; 
-2 0 2 0 0; 0 0 -2 2 1; 2 0 0 2 2; 0 0 2 2 2; 0 0 2 0 0; -2 0 1 2 2; 
0 0 0 2 0; -2 0 0 2 0; 0 0 -1 2 1; 0 2 0 0 0; 2 0 -1 0 1; -2 2 0 2 2; 
0 1 0 0 1; -2 0 1 0 1; 0 -1 0 0 1; 0 0 2 -2 0; 2 0 -1 2 1];
C=[-171996 -147.2 92025 8.9; -13187 -1.6 5736 -3.1; -2274 -0.2 977 -0.5;
2063 -0.2 -895 0.5; 1426 -3.4 54 -0.1; 712 0.1 -7 0; -517 1.2 224 -0.6;
-386 -0.4 200 0; -301 0 129 -0.1; 217 -0.5 -95 0.3; -158 0 0 0; 129 0.1 -70 0;
123 0 -53 0; 63 0 0 0; 63 0.1 -33 0; -59 0 26 0; -58 -0.1 32 0; -51 0 27 0;
48 0 0 0; 46 0 -24 0; -38 0 16 0; -31 0 13 0; 29 0 0 0; 29 0 -12 0; 26 0 0 0;
-22 0 0 0; 21 0 -10 0; 17 -0.1 0 0; 16 0 -8 0; -16 0.1 7 0; -15 0 9 0; 
-13 0 7 0; -12 0 6 0; 11 0 0 0; -10 0 5 0]*4.848136811095359e-010;

dphi=sum(sin(M*A).*(C(:,1)*t(1,:)+C(:,2)*t(2,:)));
deps=sum(cos(M*A).*(C(:,3)*t(1,:)+C(:,4)*t(2,:)));
