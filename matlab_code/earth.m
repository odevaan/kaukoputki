function [L,B,R]=earth(jde);
N=length(jde(:));
t=ones(6,1)*(jde(:)'-2451545)/365250; t(1,:)=1;
t=cumprod(t);
L=zeros(1,N); B=L; R=L;
VL0=[1.75347045673,0,0
0.03341656456,4.66925680417,6283.0758499914
0.00034894275,4.62610241759,12566.151699983
3.417571e-005,2.82886579606,3.523118349
3.497056e-005,2.74411800971,5753.3848848968
3.135896e-005,3.62767041758,77713.77146812
2.676218e-005,4.41808351397,7860.4193924392
2.342687e-005,6.13516237631,3930.2096962196
1.273166e-005,2.03709655772,529.6909650946
1.324292e-005,0.74246356352,11506.769769794
9.01855e-006,2.04505443513,26.2983197998
1.199167e-005,1.10962944315,1577.3435424478
8.57223e-006,3.50849156957,398.1490034082
7.79786e-006,1.17882652114,5223.6939198022
9.9025e-006,5.23268129594,5884.9268465832
7.53141e-006,2.53339053818,5507.5532386674
5.05264e-006,4.58292563052,18849.227549974
4.92379e-006,4.20506639861,775.522611324
3.56655e-006,2.91954116867,0.0673103028
2.84125e-006,1.89869034186,796.2980068164
2.4281e-006,0.34481140906,5486.777843175
3.17087e-006,5.84901952218,11790.629088659
2.71039e-006,0.31488607649,10977.078804699
2.0616e-006,4.80646606059,2544.3144198834
2.05385e-006,1.86947813692,5573.1428014331
2.02261e-006,2.45767795458,6069.7767545534
1.26184e-006,1.0830263021,20.7753954924
1.55516e-006,0.83306073807,213.299095438
1.15132e-006,0.64544911683,0.9803210682
1.02851e-006,0.63599846727,4694.0029547076
1.01724e-006,4.26679821365,7.1135470008
9.9206e-007,6.20992940258,2146.1654164752
1.32212e-006,3.41118275555,2942.4634232916
9.7607e-007,0.6810127227,155.4203994342
8.5128e-007,1.29870743025,6275.9623029906
7.4651e-007,1.75508916159,5088.6288397668
1.01895e-006,0.97569221824,15720.838784878
8.4711e-007,3.67080093025,71430.695618129
7.3547e-007,4.67926565481,801.8209311238
7.3874e-007,3.50319443167,3154.6870848956
7.8756e-007,3.03698313141,12036.460734888
7.9637e-007,1.807913307,17260.15465469
8.5803e-007,5.98322631256,161000.68573767
5.6963e-007,2.78430398043,6286.5989683404
6.1148e-007,1.81839811024,7084.8967811152
6.9627e-007,0.83297596966,9437.762934887
5.6116e-007,4.38694880779,14143.495242431
6.2449e-007,3.97763880587,8827.3902698748
5.1145e-007,0.28306864501,5856.4776591154
5.5577e-007,3.47006009062,6279.5527316424
4.1036e-007,5.36817351402,8429.2412664666
5.1605e-007,1.33282746983,1748.016413067
5.1992e-007,0.18914945834,12139.553509107
4.9e-007,0.48735065033,1194.4470102246
3.92e-007,6.16832995016,10447.387839604
3.5566e-007,1.77597314691,6812.766815086
3.677e-007,6.04133859347,10213.285546211
3.6596e-007,2.56955238628,1059.3819301892
3.3291e-007,0.59309499459,17789.845619785
3.5954e-007,1.70876111898,2352.8661537718
4.0938e-007,2.39850881707,19651.048481098
3.0047e-007,2.73975123935,1349.8674096588
3.0412e-007,0.44294464135,83996.847318112
2.3663e-007,0.48473567763,8031.0922630584
2.3574e-007,2.06527720049,3340.6124266998
2.1089e-007,4.14825464101,951.7184062506
2.4738e-007,0.21484762138,3.5904286518
2.5352e-007,3.16470953405,4690.4798363586
2.282e-007,5.22197888032,4705.7323075436
2.1419e-007,1.42563735525,16730.463689596
2.1891e-007,5.55594302562,553.5694028424
1.7481e-007,4.56052900359,135.0650800354
1.9925e-007,5.22208471269,12168.002696575
1.986e-007,5.77470167653,6309.3741697912
2.03e-007,0.37133792946,283.8593188652
1.4421e-007,4.19315332546,242.728603974
1.6225e-007,5.98837722564,11769.853693166
1.5077e-007,4.19567181073,6256.7775301916
1.9124e-007,3.82219996949,23581.258177318
1.8888e-007,5.38626880969,149854.40013481
1.4346e-007,3.72355084422,38.0276726358
1.7898e-007,2.21490735647,13367.972631107
1.2054e-007,2.62229588349,955.5997416086
1.1287e-007,0.17739328092,4164.311989613
1.3971e-007,4.40138139996,6681.2248533996
1.3621e-007,1.88934471407,7632.9432596502
1.2503e-007,1.13052412208,5.5229243074
1.0498e-007,5.35909518669,1592.5960136328
9.803e-008,0.99947478995,11371.704689758
9.22e-008,4.57138609781,4292.3308329504
1.0327e-007,6.19982566125,6438.4962494256
1.2003e-007,1.003514567,632.7837393132
1.0827e-007,0.32734520222,103.0927742186
8.356e-008,4.53902685948,25132.303399966
1.0005e-007,6.0291496328,5746.271337896
8.409e-008,3.29946744189,7234.794256242
8.006e-008,5.82145271907,28.4491874678
1.0523e-007,0.93871805506,11926.254413669
7.686e-008,3.12142363172,7238.6755916
9.378e-008,2.62414241032,5760.4984318976
8.127e-008,6.11228001785,4732.0306273434
9.232e-008,0.48343968736,522.5774180938
9.802e-008,5.24413991147,27511.467873537
7.871e-008,0.99590177926,5643.1785636774
8.123e-008,6.2705301365,426.598190876
9.048e-008,5.33686335897,6386.16862421
8.62e-008,4.16538210888,7058.5984613154
6.297e-008,4.71724819317,6836.6452528338
7.575e-008,3.97382858911,11499.656222793
7.756e-008,2.95729056763,23013.539539587
7.314e-008,0.60652505806,11513.883316794
5.955e-008,2.87641047971,6283.1431602942
6.534e-008,5.79072926033,18073.70493865
7.188e-008,3.99831508699,74.7815985673
7.346e-008,4.38582365437,316.3918696566
5.413e-008,5.39199024641,419.4846438752
5.127e-008,2.36062848786,10973.55568635
7.056e-008,0.32258441903,263.0839233728
6.625e-008,3.66475158672,17298.182327326
6.762e-008,5.91132535899,90955.551694496
4.938e-008,5.73672165674,9917.6968745098
5.547e-008,2.45152597661,12352.852604545
5.958e-008,3.32051344676,6283.0085396886
4.471e-008,2.06385999536,7079.3738568078
6.153e-008,1.45823331144,233141.31440436
4.348e-008,4.4234217548,5216.5803728014
6.123e-008,1.07494905258,19804.827291583
4.488e-008,3.6528503715,206.1855484372
4.02e-008,0.83995823171,20.3553193988
5.188e-008,4.06503864016,6208.2942514241
5.307e-008,0.38217636096,31441.677569757
3.785e-008,2.34369213733,3.881335358
4.497e-008,3.27230796845,11015.106477335
4.132e-008,0.92128915753,3738.761430108
3.521e-008,5.97844807108,3894.1818295422
4.215e-008,1.90601120623,245.8316462294
3.701e-008,5.03069397926,536.8045120954
3.865e-008,1.82634360607,11856.218651425
3.652e-008,1.01838584934,16200.772724501
3.39e-008,0.97785123922,8635.9420037632
3.737e-008,2.95380107829,3128.3887650958
3.507e-008,3.71291946325,6290.1893969922
3.086e-008,3.64646921512,10.6366653498
3.397e-008,1.10590684017,14712.317116458
3.334e-008,0.83684924911,6496.3749454294
2.805e-008,2.58504514144,14314.16811305
3.65e-008,1.08344142571,88860.057070987
3.388e-008,3.20185096055,5120.6011455836
3.252e-008,3.47859752062,6133.5126528568
2.553e-008,3.94869034189,1990.745017041
3.52e-008,2.05559692878,244287.60000723
2.565e-008,1.560717849,23543.230504682
2.621e-008,3.85639359951,266.6070417218
2.955e-008,3.39692949667,9225.539273283
2.876e-008,6.02635617464,154717.60988768
2.395e-008,1.16131956403,10984.1923517
3.161e-008,1.32798718453,10873.98603048
3.163e-008,5.08946464629,21228.392023546
2.361e-008,4.27212906992,6040.3472460174
3.03e-008,1.80209931347,35371.887265976
2.343e-008,3.576898605,10969.965257698
2.618e-008,2.57870156528,22483.848574493
2.113e-008,3.71393780256,65147.619768138
2.019e-008,0.81393923319,170.6728706192
2.003e-008,0.38091017375,6172.869528772
2.506e-008,3.74379142438,10575.406682942
2.381e-008,0.10581361289,7.046236698
1.949e-008,4.86892513469,36.0278666774
2.074e-008,4.2279477457,5650.2921106782
1.924e-008,5.5946054986,6282.0955289232
1.949e-008,1.07002512703,5230.807466803
1.988e-008,5.19736046771,6262.300454499
1.887e-008,3.74365662683,23.8784377478
1.787e-008,1.25929682929,12559.038152982];
VL1=[6283.3196674749,0,0
0.00206058863,2.67823455584,6283.0758499914
4.30343e-005,2.63512650414,12566.151699983
4.25264e-006,1.59046980729,3.523118349
1.08977e-006,2.96618001993,1577.3435424478
9.3478e-007,2.59212835365,18849.227549974
1.19261e-006,5.79557487799,26.2983197998
7.2122e-007,1.13846158196,529.6909650946
6.7768e-007,1.87472304791,398.1490034082
6.7327e-007,4.40918235168,5507.5532386674
5.9027e-007,2.8879703846,5223.6939198022
5.5976e-007,2.17471680261,155.4203994342
4.5407e-007,0.39803079805,796.2980068164
3.6369e-007,0.46624739835,775.522611324
2.8958e-007,2.64707383882,7.1135470008
1.9097e-007,1.84628332577,5486.777843175
2.0844e-007,5.34138275149,0.9803210682
1.8508e-007,4.96855124577,213.299095438
1.6233e-007,0.03216483047,2544.3144198834
1.7293e-007,2.99116864949,6275.9623029906
1.5832e-007,1.43049285325,2146.1654164752
1.4615e-007,1.20532366323,10977.078804699
1.1877e-007,3.25804815607,5088.6288397668
1.1514e-007,2.07502418155,4694.0029547076
9.721e-008,4.23925472239,1349.8674096588
9.969e-008,1.30262991097,6286.5989683404
9.452e-008,2.69957062864,242.728603974
1.2461e-007,2.83432285512,1748.016413067
1.1808e-007,5.2737979048,1194.4470102246
8.577e-008,5.64475868067,951.7184062506];
VL2=[0.0005291887,0,0
8.719837e-005,1.07209665242,6283.0758499914
3.09125e-006,0.86728818832,12566.151699983
2.7339e-007,0.05297871691,3.523118349];
VL3=[2.89226e-006,5.84384198723,6283.0758499914
3.4955e-007,0,0];
VL4=[1.14084e-006,3.14159265359,0];
VL5=[8.78e-009,3.14159265359,0];
VB0=[2.7962e-006,3.19870156017,84334.661581308
1.01643e-006,5.42248619256,5507.5532386674
8.0445e-007,3.88013204458,5223.6939198022
4.3806e-007,3.70444689758,2352.8661537718
3.1933e-007,4.00026369781,1577.3435424478
2.2724e-007,3.9847383156,1047.7473117547
1.6392e-007,3.56456119782,5856.4776591154
1.8141e-007,4.98367470263,6283.0758499914
1.4443e-007,3.70275614914,9437.762934887
1.4304e-007,3.41117857525,10213.285546211
1.1246e-007,4.8282069053,14143.495242431
1.09e-007,2.08574562327,6812.766815086
9.714e-008,3.47303947752,4694.0029547076
1.0367e-007,4.05663927946,71092.881354933
8.775e-008,4.44016515669,5753.3848848968
8.366e-008,4.9925151218,7084.8967811152
6.921e-008,4.32559054073,6275.9623029906
9.145e-008,1.14182646613,6620.8901131878
7.194e-008,3.60193205752,529.6909650946
7.698e-008,5.55425745881,167621.57585086
5.285e-008,2.48446991566,4705.7323075436];
VB1=[9.03e-008,3.8972906189,5507.5532386674];
VB2=[1.662e-008,1.62703209173,84334.661581308];
VB3=[1.1e-010,0.23877262399,7860.4193924392];
VB4=[4e-011,0.79662198849,6438.4962494256];
VR0=[1.00013988799,0,0
0.01670699626,3.09846350771,6283.0758499914
0.00013956023,3.0552460962,12566.151699983
3.08372e-005,5.19846674381,77713.77146812
1.628461e-005,1.17387749012,5753.3848848968
1.575568e-005,2.84685245825,7860.4193924392
9.24799e-006,5.45292234084,11506.769769794
5.42444e-006,4.56409149777,3930.2096962196
4.7211e-006,3.66100022149,5884.9268465832
3.2878e-006,5.89983646482,5223.6939198022
3.45983e-006,0.96368617687,5507.5532386674
3.06784e-006,0.29867139512,5573.1428014331
1.74844e-006,3.01193636534,18849.227549974
2.43189e-006,4.27349536153,11790.629088659
2.11829e-006,5.84714540314,1577.3435424478
1.85752e-006,5.02194447178,10977.078804699
1.09835e-006,5.05510636285,5486.777843175
9.8316e-007,0.88681311277,6069.7767545534
8.6499e-007,5.68959778254,15720.838784878
8.5825e-007,1.27083733351,161000.68573767
6.2916e-007,0.92177108832,529.6909650946
5.7056e-007,2.01374292014,83996.847318112
6.4903e-007,0.27250613787,17260.15465469
4.9384e-007,3.24501240359,2544.3144198834
5.5736e-007,5.24159798933,71430.695618129
4.2515e-007,6.01110242003,6275.9623029906
4.6963e-007,2.57805070386,775.522611324
3.8968e-007,5.36071738169,4694.0029547076
4.4661e-007,5.53715807302,9437.762934887
3.566e-007,1.67468058995,12036.460734888
3.1921e-007,0.18368229781,5088.6288397668
3.1846e-007,1.77775642085,398.1490034082
3.3193e-007,0.24370300098,7084.8967811152
3.8245e-007,2.39255343974,8827.3902698748
2.8464e-007,1.21344868176,6286.5989683404
3.749e-007,0.82952922332,19651.048481098
3.6957e-007,4.90107591914,12139.553509107
3.4537e-007,1.84270693282,2942.4634232916
2.6275e-007,4.58896850401,10447.387839604
2.4596e-007,3.78660875483,8429.2412664666
2.3587e-007,0.26866117066,796.2980068164
2.7793e-007,1.89934330904,6279.5527316424
2.3927e-007,4.99598548138,5856.4776591154
2.0349e-007,4.65267995431,2146.1654164752
2.3287e-007,2.80783650928,14143.495242431
2.2103e-007,1.95004702988,3154.6870848956
1.9506e-007,5.38227371393,2352.8661537718
1.7958e-007,0.19871379385,6812.766815086
1.7174e-007,4.43315560735,10213.285546211
1.619e-007,5.23160507859,17789.845619785
1.7314e-007,6.15200787916,16730.463689596
1.3814e-007,5.18962074032,8031.0922630584
1.8833e-007,0.67306674027,149854.40013481
1.8331e-007,2.25348733734,23581.258177318
1.3641e-007,3.68516118804,4705.7323075436
1.3139e-007,0.65289581324,13367.972631107
1.0414e-007,4.33285688538,11769.853693166
9.978e-008,4.20126336355,6309.3741697912
1.0169e-007,1.59390681369,4690.4798363586
7.564e-008,2.6256059739,6256.7775301916
9.661e-008,3.6758679122,27511.467873537
6.743e-008,0.56270332741,3340.6124266998
8.743e-008,6.06359123461,1748.016413067
7.786e-008,3.67371235637,12168.002696575
6.633e-008,5.66149277792,11371.704689758
7.712e-008,0.31242577789,7632.9432596502
6.592e-008,3.13576266188,801.8209311238
7.46e-008,5.64757188143,11926.254413669
6.933e-008,2.923845864,6681.2248533996
6.802e-008,1.4232980642,23013.539539587
6.115e-008,5.13393615454,1194.4470102246
6.477e-008,2.64986648492,19804.827291583
5.233e-008,4.62434053374,6438.4962494256
6.147e-008,3.02863936662,233141.31440436
4.608e-008,1.72194702724,7234.794256242
4.221e-008,1.55697533729,7238.6755916
5.314e-008,2.40716580847,11499.656222793
5.128e-008,5.3239896569,11513.883316794
4.77e-008,0.25554312006,11856.218651425
5.519e-008,2.09089154502,17298.182327326
5.625e-008,4.34052903053,90955.551694496
4.578e-008,4.4656964157,5746.271337896
3.788e-008,4.9072938351,4164.311989613
5.337e-008,5.09957905104,31441.677569757
3.967e-008,1.20054555174,1349.8674096588
4.008e-008,3.03007204392,1059.3819301892
3.476e-008,0.7608027703,10973.55568635
4.232e-008,1.05485713117,5760.4984318976
4.582e-008,3.76570026763,6386.16862421
3.335e-008,3.13829943354,6836.6452528338
3.418e-008,3.00072390334,4292.3308329504
3.598e-008,5.70718084323,5643.1785636774
3.237e-008,4.16448773994,9917.6968745098
4.154e-008,2.59941292162,7058.5984613154
3.362e-008,4.54577697964,4732.0306273434
2.978e-008,1.3056126882,6283.1431602942
2.765e-008,0.51311975679,26.2983197998
2.802e-008,5.66263240521,8635.9420037632
2.927e-008,5.73787481548,16200.772724501
3.164e-008,1.69140262657,11015.106477335
2.598e-008,2.96244118586,25132.303399966
3.519e-008,3.62639325753,244287.60000723
2.676e-008,4.2072570085,18073.70493865
2.978e-008,1.74971565805,6283.0085396886
2.287e-008,1.06975704977,14314.16811305];
VR1=[0.00103018608,1.10748969588,6283.0758499914
1.721238e-005,1.06442301418,12566.151699983
7.02215e-006,3.14159265359,0
3.2346e-007,1.02169059149,18849.227549974
3.0799e-007,2.84353804832,5507.5532386674
2.4971e-007,1.31906709482,5223.6939198022
1.8485e-007,1.42429748614,1577.3435424478
1.0078e-007,5.91378194648,10977.078804699];
VR2=[4.359385e-005,5.78455133738,6283.0758499914
1.23633e-006,5.57934722157,12566.151699983
1.2341e-007,3.14159265359,0];
VR3=[1.44595e-006,4.27319435148,6283.0758499914
6.729e-008,3.91697608662,12566.151699983];
VR4=[3.858e-008,2.56384387339,6283.0758499914];
VR5=[8.6e-010,1.21579741687,6283.0758499914];
L=L+sum(VL0(:,1)*ones(1,N).*cos(VL0(:,2)*ones(1,N)+VL0(:,3)*t(2,:)),1).*t(1,:);
L=L+sum(VL1(:,1)*ones(1,N).*cos(VL1(:,2)*ones(1,N)+VL1(:,3)*t(2,:)),1).*t(2,:);
L=L+sum(VL2(:,1)*ones(1,N).*cos(VL2(:,2)*ones(1,N)+VL2(:,3)*t(2,:)),1).*t(3,:);
L=L+sum(VL3(:,1)*ones(1,N).*cos(VL3(:,2)*ones(1,N)+VL3(:,3)*t(2,:)),1).*t(4,:);
L=L+sum(VL4(:,1)*ones(1,N).*cos(VL4(:,2)*ones(1,N)+VL4(:,3)*t(2,:)),1).*t(5,:);
L=L+sum(VL5(:,1)*ones(1,N).*cos(VL5(:,2)*ones(1,N)+VL5(:,3)*t(2,:)),1).*t(6,:);
L=mod2pi(L);
B=B+sum(VB0(:,1)*ones(1,N).*cos(VB0(:,2)*ones(1,N)+VB0(:,3)*t(2,:)),1).*t(1,:);
B=B+sum(VB1(:,1)*ones(1,N).*cos(VB1(:,2)*ones(1,N)+VB1(:,3)*t(2,:)),1).*t(2,:);
B=B+sum(VB2(:,1)*ones(1,N).*cos(VB2(:,2)*ones(1,N)+VB2(:,3)*t(2,:)),1).*t(3,:);
B=B+sum(VB3(:,1)*ones(1,N).*cos(VB3(:,2)*ones(1,N)+VB3(:,3)*t(2,:)),1).*t(4,:);
B=B+sum(VB4(:,1)*ones(1,N).*cos(VB4(:,2)*ones(1,N)+VB4(:,3)*t(2,:)),1).*t(5,:);
R=R+sum(VR0(:,1)*ones(1,N).*cos(VR0(:,2)*ones(1,N)+VR0(:,3)*t(2,:)),1).*t(1,:);
R=R+sum(VR1(:,1)*ones(1,N).*cos(VR1(:,2)*ones(1,N)+VR1(:,3)*t(2,:)),1).*t(2,:);
R=R+sum(VR2(:,1)*ones(1,N).*cos(VR2(:,2)*ones(1,N)+VR2(:,3)*t(2,:)),1).*t(3,:);
R=R+sum(VR3(:,1)*ones(1,N).*cos(VR3(:,2)*ones(1,N)+VR3(:,3)*t(2,:)),1).*t(4,:);
R=R+sum(VR4(:,1)*ones(1,N).*cos(VR4(:,2)*ones(1,N)+VR4(:,3)*t(2,:)),1).*t(5,:);
R=R+sum(VR5(:,1)*ones(1,N).*cos(VR5(:,2)*ones(1,N)+VR5(:,3)*t(2,:)),1).*t(6,:);
