function [L,B,R]=moonecl(jde);

T=(jde(:)'-2451545)/36525;
T2=T.*T; T3=T2.*T; T4=T2.*T2;
N=length(T);

larg=[0  0  1  0  0.109759812 -20905.355
 2  0 -1  0  0.022235966  -3699.111
 2  0  0  0  0.011489747  -2955.968
 0  0  2  0  0.003728337   -569.925
 0  1  0  0 -0.003230884     48.888
 0  0  0  2 -0.001995470     -3.149
 2  0 -2  0  0.001026131    246.158
 2 -1 -1  0  0.000995990   -152.138
 2  0  1  0  0.000930644   -170.733
 2 -1  0  0  0.000798628   -204.586
 0  1 -1  0 -0.000714241   -129.620
 1  0  0  0 -0.000605978    108.743
 0  1  1  0 -0.000530283    104.755
 2  0  0 -2  0.000267507     10.321
 0  0  1  2 -0.000218655      0.000
 0  0  1 -2  0.000191637     79.661
 4  0 -1  0  0.000186314    -34.782
 0  0  3  0  0.000175126    -23.210
 4  0 -2  0  0.000149191    -21.636
 2  1 -1  0 -0.000137672     24.208
 2  1  0  0 -0.000118089     30.824
 1  0 -1  0 -0.000090111     -8.379
 1  1  0  0  0.000087040    -16.675
 2 -1  1  0  0.000070441    -12.831
 2  0  2  0  0.000069708    -10.445
 4  0  0  0  0.000067387    -11.650
 2  0 -3  0  0.000063966     14.403
 0  1 -2  0 -0.000046932     -7.003
 2  0 -1  2 -0.000045413      0.000
 2 -1 -2  0  0.000041713     10.056
 1  0  1  0 -0.000040980      6.322
 2 -2  0  0  0.000039026     -9.884
 0  1  2  0 -0.000037001      5.751
 0  2  0  0 -0.000036111      0.000
 2 -2 -1  0  0.000035744     -4.950
 2  0  1 -2 -0.000030945      4.130
 2  0  0  2 -0.000027838      0.000
 4 -1 -1  0  0.000021206     -3.958
 0  0  2  2 -0.000019373      0.000
 3  0 -1  0 -0.000015568      3.258
 2  1  1  0 -0.000014137      2.616
 4 -1 -2  0  0.000013247     -1.897
 0  2 -1  0 -0.000012444     -2.117
 2  2 -1  0 -0.000012217      2.354
 2  1 -2  0  0.000012060      0.000
 2 -1  0 -2  0.000010402      0.000
 4  0  1  0  0.000009582     -1.423
 0  0  4  0  0.000009372     -1.117
 4 -1  0  0  0.000009076     -1.571
 1  0 -2  0 -0.000008500     -1.739
 2  1  0 -2 -0.000006964      0.000
 0  0  2 -2 -0.000006650     -4.421
 1  1  1  0  0.000006126      0.000
 3  0 -2  0 -0.000005934      0.000
 4  0 -3  0  0.000005760      0.000
 2 -1  2  0  0.000005707      0.000
 0  2  1  0 -0.000005637      1.165
 1  1 -1  0  0.000005219      0.000
 2  0  3  0  0.000005131      0.000
 2  0 -1 -2  0.000000000      8.752];
barg=[0  0  0  1  0.089502613
 0  0  1  1  0.004897429
 0  0  1 -1  0.004846657
 2  0  0 -1  0.003023556
 2  0 -1  1  0.000967139
 2  0 -1 -1  0.000807581
 2  0  0  1  0.000568506
 0  0  2  1  0.000300162
 2  0  1 -1  0.000161722
 0  0  2 -1  0.000153973
 2 -1  0 -1  0.000143396
 2  0 -2 -1  0.000075468
 2  0  1  1  0.000073304
 2  1  0 -1 -0.000058626
 2 -1 -1  1  0.000042987
 2 -1  0  1  0.000038589
 2 -1 -1 -1  0.000036041
 0  1 -1 -1 -0.000032638
 4  0 -1 -1  0.000031905
 0  1  0  1 -0.000031311
 0  0  0  3 -0.000030526
 0  1 -1  1 -0.000027314
 1  0  0  1 -0.000026023
 0  1  1  1 -0.000025744
 0  1  1 -1 -0.000024609
 0  1  0 -1 -0.000023457
 1  0  0 -1 -0.000023300
 0  0  3  1  0.000019321
 4  0  0 -1  0.000017820
 4  0 -1  1  0.000014539
 0  0  1 -3  0.000013561
 4  0 -2  1  0.000011711
 2  0  0 -3  0.000010594
 2  0  2 -1  0.000010402
 2 -1  1 -1  0.000008570
 2  0 -2  1 -0.000007871
 0  0  3 -1  0.000007662
 2  0  2  1  0.000007365
 2  0 -3 -1  0.000007348
 2  1 -1  1 -0.000006388
 2  1  0  1 -0.000006126
 4  0  0  1  0.000005777
 2 -1  1  1  0.000005498
 2 -2  0 -1  0.000005271
 0  0  1  3 -0.000004939
 2  1  1 -1 -0.000003997
 1  1  0 -1  0.000003892
 1  1  0  1  0.000003892
 0  1 -2 -1 -0.000003840
 2  1 -1 -1 -0.000003840
 1  0  1  1 -0.000003229
 2 -1 -2 -1  0.000003159
 0  1  2  1 -0.000003089
 4  0 -2 -1  0.000003072
 4 -1 -1 -1  0.000002897
 1  0  1 -1 -0.000002862
 4  0  1 -1  0.000002304
 1  0 -1 -1 -0.000002077
 4 -1  0 -1  0.000002007
 2 -2  0  1  0.000001868];

P=[5.19846674102744+7771.37714681292*T-2.84488668075076e-005*T2+3.1973467065194e-008*T3+1.54365122008962e-010*T4
6.24006012726235+628.301955167228*T-2.68082573106329e-006*T2+7.12670172312915e-010*T3
2.35555589865365+8328.69142695478*T+0.00015702727280193*T2+2.50409511182991e-007*T3-1.18633037791893e-009*T4
1.6279052330321+8433.46615813073*T-5.9391809116115e-005*T2-4.94988443560502e-009*T3+2.02167153397311e-011*T4];
P=rem(P,2*pi);
Lp=rem(3.81034102259054+8399.70911352157*T-2.31570285154608e-005*T2+4.86379553059525e-008*T3-2.67713171763403e-010*T4,2*pi);
A1=rem(2.090032+2.301199*T,2*pi);
A2=rem(0.926595+8364.739848*T,2*pi);
A3=rem(0734+8399.684725*T,2*pi);
E=1-0.002516*T-0.0000074*T2;
E2=E.*E;

M=60;
A=larg(:,1:4)*P;
ind1=[5 8 10 11 13 20 21 23 24 28 30 33 38 41 42 45 46 49 51 53 56 58];
ind2=[32 34 35 43 44 57];
C=larg(:,5)*ones(1,N);
C(ind1,:)=ones(22,1)*E.*C(ind1,:);
C(ind2,:)=ones(6,1)*E2.*C(ind2,:);
add=[0.000069080 0.000034243 0.000005550]*sin([A1; Lp-P(4,:); A2]);
L=Lp+sum(C.*sin(A),1)+add;
C=larg(:,6)*ones(1,N);
C(ind1,:)=ones(22,1)*E.*C(ind1,:);
C(ind2,:)=ones(6,1)*E2.*C(ind2,:);
R=sum(C.*cos(A),1)+385000.56;

A=barg(:,1:4)*P;
ind1=[11 14 15 16 17 18 20 22 24 25 26 35 40 41 43 46 47 48 49 50 52 53 55 59];
ind2=[44 60];
C=barg(:,5)*ones(1,N);
C(ind1,:)=ones(24,1)*E.*C(ind1,:);
C(ind2,:)=ones(2,1)*E2.*C(ind2,:);
add=[-0.000039008  0.000006667  0.000003054  0.000003054  0.000002217 -0.000002007]*sin([Lp; A3; A1-P(4,:); A1+P(4,:); Lp-P(3,:); Lp+P(3,:)]);
B=sum(C.*sin(A),1)+add;
